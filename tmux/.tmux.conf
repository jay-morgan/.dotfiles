#############
## OPTIONS ##
#############

set-option -g history-limit 100000
set-option -g focus-events on
set-option -sa terminal-features ',xterm-256color:RGB'
set-option -g detach-on-destroy off
set -sg escape-time 0
set -g mode-keys vi
set -g mouse off
set -g base-index 1

#################
## KEYBINDINGS ##
#################

# toggle title bar key bin
bind-key C-j set-option -g status

#TODO's with shift + d
bind -r D neww -c "#{pane_current_path}" "[[ -e TODO.md ]] && nvim TODO.md || nvim ~/personal/.dotfiles/todo.md"

# add cheatsheet bind key
bind-key -r i run-shell "tmux new-window 'bash -i ~/.local/bin/cheatsheet'"

# cascadig close switcher - close the current pane, if it's the last pane in the window, close the window, if it's the last window, switch to the next session, if it's the last session, exit tmux
bind C-d run-shell "~/.local/bin/tmux-cascading-close-switcher"

# unbind the prefix and bind it to Ctrl-a like screen
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# mapped to kinesis360 for single kepress for prefix
bind-key -n F12 send-prefix

# copy to X clipboard
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe 'xclip -in -selection clipboard &> /dev/null'
bind -T copy-mode-vi Enter send-keys -X cancel

# shortcut for moving tmux buffer to clipboard, useful if you've selected with the mouse
bind-key -nr C-y run "tmux show-buffer | xclip -in -selection clipboard &> /dev/null"

# create a keybinding to kill the current session and attach to the previous one
bind-key -r k run-shell "tmux switch-client -l && tmux kill-session -t $(tmux display-message -p '#S')"

# move between panes with vim bindings
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# resize pane bindings with shift and arrow keys
bind -n S-Up resize-pane -U
bind -n S-Down resize-pane -D
bind -n S-Left resize-pane -L
bind -n S-Right resize-pane -R

#############
## PLUGINS ##
#############

# save and restore tmux sessions
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
# Enable auto restore on tmux server start
set -g @continuum-restore 'on'
# Enable nvim and pane auto restore
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-capture-pane-contents 'on'

# rose pine theme
set -g @plugin 'rose-pine/tmux'
# select variant, options are 'main', 'moon' or 'dawn'
set -g @rose_pine_variant 'moon'

# theme options
set -g @rose_pine_only_windows 'on' # leaves only the window module, for max focus and space
set -g @rose_pine_show_pane_directory 'on' # forces tmux to show the current directory
set -g @rose_pine_bar_bg_disable 'on' # if set to 'on', disables background color, for transparent terminal emulators
set -g @rose_pine_bar_bg_disabled_color_option 'default'
# if @rose_pine_bar_bg_disable is set to 'on', uses the provided value to set the background color it can be any of 
# the on tmux (named colors, 256-color set, `default` or hex colors) 
# see more on http://man.openbsd.org/OpenBSD-current/man1/tmux.1#STYLES

# set -g @rose_pine_disable_active_window_menu 'on' # disables the menu that shows the active window on the left
# set -g @rose_pine_date_time '%R' # it accepts the date UNIX command format (man date for info)
# set -g @rose_pine_host 'on' # enables hostname in the status bar
# set -g @rose_pine_default_window_behavior 'on' # forces tmux default window list behaviour
# set -g @rose_pine_user 'off' # turn on the username component in the statusbar
# set -g @rose_pine_show_current_program 'on' # forces tmux to show the current running program as window name

set -g @rose_pine_window_status_separator " | " # changes the default icon that appears between window names
set -g @rose_pine_left_separator ' ' # the strings to use as separators are 1-space padded
# set -g @rose_pine_right_separator ' ' # accepts both normal chars & nerdfont icons
# set -g @rose_pine_field_separator ' | ' # 1-space padding, it updates with prefix + I
# set -g @rose_pine_session_icon '' # changes the default icon to the left of the session name
# set -g @rose_pine_current_window_icon '' # changes the default icon to the left of the active window name
# set -g @rose_pine_folder_icon '' # changes the default icon to the left of the current directory folder
# set -g @rose_pine_username_icon '' # changes the default icon to the right of the hostname
# set -g @rose_pine_hostname_icon '󰒋' # changes the default icon to the right of the hostname
# set -g @rose_pine_date_time_icon '󰃰' # changes the default icon to the right of the date module

# gruvbox dark theme
# set -g @plugin 'tinted-theming/base16-tmux'
# select variant
# set -g @colors-base16 'gruvbox-dark-hard'

####################
## DESIGN CHANGES ##
####################

# hide title bar
# set-option -g status off

# minimal status bar style with no plugins
# set -g set-titles on
# set -g set-titles-string "#T"
# set -g status-style bg="default", fg="00000"
# set -g status-right ''
# set -g status-right-length 0

########################################################
############ INITIALIZE TMUX PLUGIN MANAGER ############
### (keep this line at the very bottom of tmux.conf) ###
########################################################

run '~/.tmux/plugins/tpm/tpm'
